# 服务端性能优化

## QPS，amdahl，gustason

RT（response time）=thread cpu time+thread wait time

单线程qps=1000ms/RT

最佳线程数=（RT/cpuTime）* cpu核心数 * cpu利用率

已知最佳线程数，求最大qps

则最大qps=单线程qps*最佳线程数

=1000ms/RT * RT/cpuTime * cpu核心数*cpu利用率

=1000ms/cpuTime * cpu核心数&cpu利用率

#### amdahl定律（安达尔定律）

描述可伸缩性

> 可伸缩性指，当增加计算资源时（如cpu，内存，带宽等），qps能进行相应的改进。

另外amdal描述可伸缩性是指：在系统中，基于可并行化和串行化的组件各自所占的比例，当程序获得额外的计算资源时，系统理论上可以获得的加速值（qps或其他指标可以翻几倍）。

F表示必须串行化执行的比例，则在一个N核处理器的机器中，加速值：

$Sppedup<=1/(F+(1-F)/N)$

如一个女人生一个孩子需要9月，9个女人不可能在一个月内生一个孩子。

N=9（9个人代表9个核心），生孩子的串行率是100%，则speedup=1/1=1,没有加速。



当线程数不断增加的时候，到达某个零界点后开始对系统产生负面影响。



## 同步模型与异步模型



